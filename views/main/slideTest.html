<!-- views/index.njk -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>슬라이드 메인 - 4개씩 표시 (총 17개 데이터)</title>
  <link rel="stylesheet" href="/css/maincss/slideTest.css">
</head>
    <body>
        <div class="slider">
            <!-- 슬라이드 아이템들이 들어갈 영역 -->
                <div class="slide-container" id="slideContainer">
                <!-- 아이템들은 JS에서 이곳으로 동적으로 생성됩니다. -->
                </div>
            <!-- 좌우 이동 버튼 -->
            <div class="controls">
                <button id="prevBtn">이전</button>
                <button id="nextBtn">다음</button>
            </div>
        </div>
        <div id="dataHolder" style="display: none;">{{ items | dump }}</div>
        <script>
            // hidden 요소에서 items 데이터를 가져와 파싱합니다.
            const dataHolder = document.getElementById("dataHolder");
            const items = JSON.parse(dataHolder.textContent);

            const slideContainer = document.getElementById("slideContainer");
            const prevBtn = document.getElementById("prevBtn");
            const nextBtn = document.getElementById("nextBtn");

            let currentIndex = 0;
            const totalItems = items.length;
            const visibleCount = 4; // 한 화면에 보여줄 아이템 수

            // 슬라이드 영역에 visibleCount 개의 아이템을 렌더링하는 함수
            const renderSlides = () => {
                slideContainer.innerHTML = "";
                for (let i = 0; i < visibleCount; i++) {
                    // wrap-around 처리: 인덱스가 totalItems를 넘으면 0부터 다시 시작
                    const index = (currentIndex + i) % totalItems;
                    const item = items[index];
                    console.log(item);
                
                    // 아이템 엘리먼트 생성 및 내용 채우기
                    const itemDiv = document.createElement("div");
                    itemDiv.className = "item";
                    itemDiv.innerHTML = `<img src="${item.cover}" alt="이미지 없음 ㅠ">`;
                    slideContainer.appendChild(itemDiv);
                }
            };

            // 최초 렌더링: 처음 4개 아이템 표시
            renderSlides();

            // 이전 버튼 클릭 이벤트: currentIndex를 1 감소 (wrap-around 처리)
            prevBtn.addEventListener("click", () => {
                currentIndex = (currentIndex - 1 + totalItems) % totalItems;
                renderSlides();
            });

            // 다음 버튼 클릭 이벤트: currentIndex를 1 증가 (wrap-around 처리)
            nextBtn.addEventListener("click", () => {
                currentIndex = (currentIndex + 1) % totalItems;
                renderSlides();
            });
            setInterval(() => {
            currentIndex = (currentIndex + 1) % totalItems;
            renderSlides();
            }, 3000); // 3초 후 실행
        
        </script>
    </body>
</html>
